\documentclass[a4paper,11pt]{article}
\usepackage[T1]{fontenc}
\usepackage[latin1]{inputenc}
\usepackage{graphicx}
% \usepackage{algorithmic}
% \usepackage{algorithm}
\usepackage[round]{natbib}
\usepackage{url}
\usepackage{booktabs}
\usepackage{dcolumn}
\usepackage{amsmath}
\usepackage{bm}
\usepackage{lmodern}
\usepackage{microtype}
\usepackage{makeidx}
\usepackage[english,spanish,basque]{babel}
\selectlanguage{spanish}
\usepackage{ifthen}
% \usepackage{afterpage}
\usepackage{tikz}
\usetikzlibrary{shapes,arrows,shadows,babel}

\input  variantes.tex


\def\iS{\selectlanguage{spanish}}%
\def\iB{\selectlanguage{basque}}%
\def\iE{\selectlanguage{english}}%

\DeclareGraphicsRule{eps.gz}{epe}{eps.bb}{`gzip -d #1}

% \setkeys{Gin}{width=0.9\textwidth}

\makeindex
\title{Documentación para \texttt{EA3examen}}
% \author{F. Tusell}
\date{23 marzo 2016}

\begin{document}
\maketitle

\section{Introducción}

\texttt{EA3examen} es un conjunto de plantillas, macros en \LaTeX{} y
funciones en \textsc{R} y en \textsc{ELISP} para Emacs que buscan
facilitar la producción de exámenes multilingües con múltiples modelos
en cada idioma. Pueden utilizarse sólo partes, como las definiciones
en \LaTeX, que pueden emplearse en cualquier documento, examen o no,
en uno o en varios idiomas.

La producción de exámenes hace uso del paquete \texttt{examdesign}.


\section{Modus operandi}

El flujo de trabajo se recoge esquemáticamente en la
Figura~\ref{flujo}, \pageref{flujo}. El usuario prepara el fichero
maestro alternativamente en formato \texttt{.Rnw} o \texttt{.tex}. El
primer formato se emplea cuando hay material que requiere ser
procesado por R (cálculos, tablas estadísticas, gráficas. etc.). Tal
material se inserta en un fichero nombrado con extensión \texttt{.Rnw}
en bloques tales como
\medskip

\noindent\texttt{<{}<>{}>=}\par
\noindent\texttt{library(MASS)}\par
\noindent\texttt{@}\par
\bigskip

\noindent en que los delimitadores \texttt{<{}<>{}>=} y \texttt{@}
señalan fragmentos de código que se ejecuta e inserta automáticamente
en un nuevo fichero en formato \LaTeX{} standard. Las variantes
idiomáticas, por su parte, se codifican señalando las líneas en cada
idioma con un prefijo, del modo siguiente:

\begin{verbatim}
ES- Estadística y probabilidad...
EN- Statistics and probability...
EU- Estatistika eta probabilitatea...
\end{verbatim}

Estas líneas se copian tal cual al fichero \texttt{.tex} al procesar
el fichero \texttt{.Rnw}. Algunas funciones en Emacs ayudan a editar
el texto variante.

En la etapa posterior, se generan las vesiones para los idiomas que se
hayan configurado. Un único golpe de tecla en Emacs genera a partir
del documento precursor tantos otros como idiomas, con nombres iguales
al del precursor prefijados por el idioma (\texttt{EN.fichero.tex},
\texttt{ES.fichero.tex}, etc. Éstos son tratados como ficheros
\LaTeX{} ordinarios que son, dando lugar cada uno al documento final
en un idioma y el formato que se haya escogido, normalmente PDF.

\pgfdeclarelayer{background}
\pgfdeclarelayer{foreground}
\pgfsetlayers{background,main,foreground}

\tikzstyle{input}=[draw, fill=red!20, text width=5em,
    text centered, minimum height=3em, rounded corners, drop shadow]
\tikzstyle{output}=[draw, fill=blue!20, text width=5em,
    text centered, minimum height=3em, rounded corners, drop shadow]
\tikzstyle{ba} = [input, text width=5em, fill=blue!20,
    minimum height=3em, rounded corners, drop shadow]
\def\blockdist{3.3}
\def\edgedist{2.5}
\def\interblock{2.4}

\begin{figure}
\selectlanguage{spanish}
\caption{Proceso de generación de documentos con
  \texttt{EA3examen}. El usuario genera uno de los dos ficheros en
  color salmón, mientras que los ficheros en color lavanda se generan
  automáticamente.}
\bigskip\bigskip
\label{flujo}

\begin{tikzpicture}[>=triangle 60]
\node (ba) [ba]  {\LaTeX\\ \texttt{.tex}};
\path (ba.west)+(-\interblock, 1.5) node (rnw) [input] {Sweave\\ \texttt{.Rnw}};
\path (ba.west)+(-\interblock,-1.5) node (tex) [input] {\LaTeX\\ \texttt{.tex}};
\path (ba.east)+( \interblock, 1.5) node (EN) [output] {EN \\ \texttt{.tex}};
\path (ba.east)+( \interblock, 0.0) node (ES) [output] {ES \\ \texttt{.tex}};
\path (ba.east)+( \interblock,-1.5) node (EU) [output] {EU \\ \texttt{.tex}};
\path (EN.east)+( \interblock, 0.0) node (ENpdf) [output] {EN \\ \texttt{.pdf}};
\path (ES.east)+( \interblock, 0.0) node (ESpdf) [output] {ES \\ \texttt{.pdf}};
\path (EU.east)+( \interblock, 0.0) node (EUpdf) [output] {EU \\ \texttt{.pdf}};


\path [draw, ->] (rnw.east) -- node [above] {}  (ba.175) ;
\path [draw, ->] (tex.east) -- node [above] {}  (ba.185);
\path [draw, ->] (ba.east)  -- node [left] {}  (EN.180);
\path [draw, ->] (ba.east)  -- node [above] {}  (ES.180);
\path [draw, ->] (ba.east)  -- node [above] {}  (EU.180);
\path [draw, ->] (EN.east)  -- node [above] {}  (ENpdf.180);
\path [draw, ->] (ES.east)  -- node [above] {}  (ESpdf.180);
\path [draw, ->] (EU.east)  -- node [above] {}  (EUpdf.180);


%     \path (ba.south) +(1.5,-\blockdist) node (asrs) {Proceso generación exámenes};
    %  \begin{pgfonlayer}{background}
    %      \path (rnw.west |- rnw.north)+(-0.5,0.3) node (a) {};
    %      \path (ba.south -| ba.east)+(+0.5,-0.3) node (b) {};
    %      \path (EUpdf.east |- asrs.east)+(+0.5,-0.5) node (c) {};

    %     \path[fill=yellow!20,rounded corners, draw=black!50] %  dashed]
    %         (a) rectangle (c);
    %     \path (rnw.north west)+(-0.2,0.2) node (a) {};
    % \end{pgfonlayer}

\end{tikzpicture}
\bigskip
\end{figure}

\texttt{EA3examen} requiere una instalación razonablemente completa de
\LaTeX{} incluyendo el paquete \texttt{examdesign} y los siguientes
ficheros, con expresión de los lugares donde deben instalarse:

\begin{table}[h!]
\small
\begin{tabular}{lll}
\toprule
\textbf{Fichero} & \textbf{Ubicación} & \textbf{En Linux, típicamente:} \\
\midrule
\texttt{EA3examen.sty} & Formatos \LaTeX{}, & \verb|/usr/local/share/texmf/tex/latex|\\
\texttt{variantes.tex} & Formatos \LaTeX{}, & \verb|/usr/local/share/texmf/tex/latex|\\
\texttt{EA3examen.el}  & Ficheros ELisp,    & \verb|/usr/local/share/emacs/site-lisp|\\
\bottomrule
\end{tabular}
\normalsize
\end{table}

\newpage
\section{Macrodefiniciones}

\subsection{Locuciones frecuentes}

Son expresiones en modo texto que se insertan a veces en una fórmula o
entre fórmulas, y constituyen los únicos elementos que requerirían
traducción. El uso de estos macros permite utilizar una única
expresión para todos los idiomas. Son frecuentes ``sí'', ``no'',
``cierto'', ``falso'' y la opción
\verb|\af| en las preguntas de elección múltiple, para
proporcionar una respuesta correcta cuando ninguna más lo es.

\begin{table}[h!]
\centering
\caption{Locuciones frecuentes}
\bigskip
\small\setlength{\tabcolsep}{-32pt}
\begin{tabular}{@{}l@{\extracolsep{-35pt}}ccc}
\toprule
 & \multicolumn{3}{c}{\textbf{Variantes idiomáticas}}  \\[1mm]
\textbf{Macro} & \textbf{Español} & \textbf{Euskera} & \textbf{Inglés} \\
\midrule
\verb|\af|      & \iS\parbox[c]{1.25in}{\af}
                & \iB  \parbox[c]{1.25in}{\af}
                & \iE \parbox[c]{1.25in}{\af}   \\[3mm]
\verb|\cierto|  & \iS\cierto & \iB \cierto  & \iE \cierto    \\
\verb|\falso|   & \iS\falso  & \iB \falso   & \iE \falso     \\[1mm]
\verb|\ii|      & \iS\parbox[c]{1.25in}{\ii}
                & \iB  \parbox[c]{1.25in}{\ii}
                & \iE \parbox[c]{1.25in}{\ii}   \\[3mm]
\verb|\no   |   & \iS\no     & \iB \no      & \iE \no \\
\verb|\Sesgo|   & \iS\Sesgo  & \iB \Sesgo   & \iE \Sesgo \\
\verb|\si   |   & \iS\si     & \iB \si      & \iE \si \\
\verb|\Var|     & \iS\Var    & \iB \Var     & \iE \Var   \\
\verb|\Y|       & \iS\Y      & \iB \Y       & \iE \Y     \\
\bottomrule
\end{tabular}
\normalsize
\end{table}

\subsection{Notación matemática}

\paragraph{Constantes.}
Constantes de uso frecuente como parte de expresiones.

\begin{table}[h!]
\centering
\caption{Constantes frecuentes}
\bigskip
\small\setlength{\tabcolsep}{-2pt}
\begin{tabular}{@{}l@{\extracolsep{-15pt}}ccc}
\toprule
 & \multicolumn{3}{c}{\textbf{Variantes idiomáticas}}  \\[1mm]
\textbf{Macro} & \textbf{Español} & \textbf{Euskera} & \textbf{Inglés} \\
\midrule
\verb|\oh|       & \iS\oh  & \iB\oh   & \iE\oh    \\[1mm]
\verb|\rdpi|       & \iS\rdpi  & \iB\rdpi   & \iE\rdpi    \\
\bottomrule
\end{tabular}
\normalsize
\end{table}


\paragraph{Estimadores.}
\label{estimadores}
El macro \verb|\est| no está destinado a ser invocado directamente,
aunque puede serlo. Sirve como base a \verb|\emv| y similares, que
tienen variantes idiomáticas.

\begin{table}[h!]
\centering
\caption{Estimadores frecuentes}
\bigskip
\small\setlength{\tabcolsep}{-10pt}
\begin{tabular}{@{}l@{\extracolsep{-15pt}}ccc}
\toprule
 & \multicolumn{3}{c}{\textbf{Variantes idiomáticas}}  \\[1mm]
\textbf{Macro} & \textbf{Español} & \textbf{Euskera} & \textbf{Inglés} \\
\midrule
\verb|\est{a}{b}|   & \iS\est{a}{b}  & \iB\est{a}{b}   & \iE\est{a}{b}   \\
\verb|\emv{\theta}|   & \iS\emv{\theta}  & \iB\emv{\theta}   & \iE\emv{\theta}   \\
\verb|\emom{\theta}|  & \iS\emom{\theta} & \iB\emom{\theta}  & \iE\emom{\theta}   \\
\bottomrule
\end{tabular}
\normalsize
\end{table}

La macro  \verb|\est| y sus derivadas están previstas para emplearse
sobre expresiones simples, sobre las que pueda ponerse fácilmente un
acento circunflejo. En ocasiones habrá que recurrir a dejar parte de
la expresión que se estima fuera del argumento. Véase por ejemplo la
diferencia entre estas dos formas de escribir el estimador máximo
verosímil de $\sigma^2$:
\bigskip

\begin{tabular}[h!]{lc@{$\Rightarrow$}cl}
\verb|El estimador \emv{\sigma^2}...| &&& El estimador $\emv{\sigma^2}\ldots$ \\
\verb|El estimador \emv{\sigma}^2...| &&& El estimador $\emv{\sigma}^2\ldots$ \\
\end{tabular}

\paragraph{Funciones y expresiones.}
\mbox{ }
\begin{table}[htb]
\centering
\caption{Funciones y expresiones frecuentes}
\bigskip
\small\setlength{\tabcolsep}{-25pt}
\begin{tabular}{@{}r@{\extracolsep{-10pt}}ccc}
\toprule
 & \multicolumn{3}{c}{\textbf{Variantes idiomáticas}}  \\[1mm]
\textbf{Macro} & \textbf{Español} & \textbf{Euskera} & \textbf{Inglés} \\
\midrule
\verb|\f{x}|       & \iS\f{x}  & \iB\f{x}   & \iE\f{x}   \\
\verb|\F{x}|       & \iS\F{x}  & \iB\F{x}   & \iE\F{x}   \\
\verb|\charf{x}|    & \iS\charf{x}  & \iB\charf{x}   & \iE\charf{x}   \\
\verb|\momg{x}|    & \iS\momg{x}  & \iB\momg{x}   & \iE\momg{x}   \\
\verb|\ecm{\hat\theta}| & \iS\ecm{\hat{\theta}} & \iB\ecm{\hat{\theta}} & \iE\ecm{\hat{\theta}} \\
\bottomrule
\end{tabular}
\normalsize
\end{table}

\index{macros!ecm@\texttt{ecm}}
\index{macros!momg@\texttt{momg}}
\index{macros!charf@\texttt{charf}}
\index{macros!f@\texttt{f}}
% \index{macros!F@\texttt{F}\;[\f{x}]}

Como argumento de \verb|ecm| se pueden
insertar cualesquiera estimadores de los definidos en la
subsección~\ref{estimadores}. Por ejemplo, podemos escribir:
\bigskip

\selectlanguage{spanish}
\small
\noindent\begin{tabular}[l]{lp{0.5cm}l}
El \verb|\ecm{\emv{\theta}}| es$\ldots$  &  & El \ecm{\emv{\theta}}
es$\ldots$ \\[3mm]
\verb|\ecm{\emv{\pi}} = \ecm{\emom{\pi}}| & & $\ecm{\emv{\pi}}
= \ecm{\emom{\pi}}$ \\[3mm]
\verb|\ecm{\hat\pi} =|& & $\ecm{\hat\pi} =
  \Sesgo(\hat\pi) + \Var(\hat\pi)$ \\
\qquad \verb|\Sesgo(\hat\pi) + \Var(\hat\pi)|  \\
\end{tabular}
\normalsize


\paragraph{Límites.}
Un macro general, \verb|\anylim{texto}| sitúa ``texto'' sobre una flecha
hacia la derecha. No está destinado a ser invocado directamente,
aunque puede serlo. Hay especializaciones para límites en distribución,
probabilidad y casi seguros (o ``con probabilidad unitaria'') que
tienen variantes idiomáticas..


\begin{table}[h!]
\centering
\caption{Límites probabilisticos}
\bigskip
\small\setlength{\tabcolsep}{-2pt}
\begin{tabular}{@{}r@{}ccc}
\toprule
 & \multicolumn{3}{c}{\textbf{Variantes idiomáticas}}  \\[1mm]
\textbf{Macro} & \textbf{Español} & \textbf{Euskera} & \textbf{Inglés} \\
\midrule
\verb|\anylim{texto}|       & \iS\anylim{texto}  & \iB\anylim{texto}   & \iE\anylim{texto}    \\
\verb|\dlim|    & \iS\dlim  & \iB \dlim  & \iE \dlim \\
\verb|\plim|    & \iS\plim  & \iB \plim  & \iE \plim \\
\verb|\cslim|   & \iS\cslim & \iB \cslim & \iE \cslim \\
\bottomrule
\end{tabular}
\normalsize
\end{table}


\newpage

\printindex


\end{document}
